# Example: Worker Configuration
# This file demonstrates all available configuration options for a worker

# Path prefix for this worker (required)
# This is the URL path where this worker will be mounted
# Examples: "/" for root, "/api" for API endpoints, "/admin" for admin panel
path: "/" # Required - no default

# Worker runtime settings
runtime:
  # Maximum number of CPU cores/threads to use
  # Sets Go's GOMAXPROCS environment variable
  # 0 = use all available CPU cores
  # 1 = single-threaded execution
  # N = limit to N cores
  go_max_procs: 1 # Default: 1

  # Maximum memory limit for this worker
  # Sets Go's GOMEMLIMIT environment variable
  # Examples: "256MiB", "512MiB", "1GiB", "2GiB"
  # Empty string or null = unlimited memory
  go_mem_limit: "" # Default: "" (unlimited)

  # Restart worker after processing N requests
  # Helps prevent memory leaks and refresh resources
  # 0 = never restart based on request count
  max_requests: 0 # Default: 0 (unlimited)

# Timeout settings (in seconds)
timeouts:
  # HTTP read timeout - time allowed to read the request
  # Includes reading the request body
  read_timeout_seconds: 30 # Default: 30

  # HTTP write timeout - time allowed to write the response
  # Includes time to generate and write the response body
  write_timeout_seconds: 30 # Default: 30

  # HTTP idle timeout - keep-alive timeout
  # Time to wait for the next request when using keep-alives
  idle_timeout_seconds: 120 # Default: 120

# Logging configuration
logging:
  # Log file path for this worker
  # Placeholders:
  #   {name} = worker name (derived from path, e.g., "index" for "/", "api" for "/api")
  #   {path} = worker path with slashes replaced (e.g., "api_users" for "/api/users")
  #   {date} = current date in YYYY-MM-DD format
  #
  # Use null, empty string, or ~ to disable file logging
  # When disabled, logs only go to stdout/stderr
  log_file: "logs/worker_{name}_{date}.log" # Default: logs/worker_{name}_{date}.log

# Additional notes:
# - Most settings can be overridden at the server level in server.yaml
# - Server-level defaults apply to all workers unless overridden here
# - Resource limits help isolate workers and prevent one from affecting others
# - Timeouts should be tuned based on your application's needs
