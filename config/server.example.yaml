# Example: Custom TQServer Configuration
# This file demonstrates all available configuration options

# Server settings
server:
  # Port for the main HTTP server to listen on
  port: 3000 # Default: 8080

  # Timeouts for HTTP server (in seconds)
  read_timeout_seconds: 60 # Default: 30 - Time allowed to read request
  write_timeout_seconds: 60 # Default: 30 - Time allowed to write response
  idle_timeout_seconds: 180 # Default: 120 - Keep-alive timeout

# Worker settings
workers:
  # Port range for worker processes
  # Workers are assigned ports sequentially from this range
  # Make sure the range is large enough for all your pages
  port_range_start: 10000 # Default: 9000
  port_range_end: 19999 # Default: 9999

  # Worker startup settings (in milliseconds)
  startup_delay_ms: 200 # Default: 100 - Time to wait for worker to start before routing traffic

  # Graceful restart settings (in milliseconds)
  restart_delay_ms: 200 # Default: 100 - Delay before stopping old worker
  shutdown_grace_period_ms: 1000 # Default: 500 - Time to wait for graceful shutdown

  # Default per-worker configuration (applies to all workers unless overridden)
  default:
    num_procs: 2 # Default: 1 - Number of processes per worker route
    max_requests: 10000 # Default: 0 (unlimited) - Restart worker after N requests
    request_timeout_seconds: 60 # Default: 30 - Request timeout for workers
    idle_timeout_seconds: 180 # Default: 120 - Idle timeout for workers
    memory_limit_mb: 512 # Default: 0 (unlimited) - Memory limit per worker in MB

  # Per-path worker configuration overrides (optional)
  # Use this to apply different resource limits to specific routes
  paths:
    # Example: Limit resources for API endpoints
    "/api":
      num_procs: 2
      max_requests: 5000
      request_timeout_seconds: 15
      idle_timeout_seconds: 60
      memory_limit_mb: 256

    # Example: Allow more resources for webhooks
    "/webhooks":
      num_procs: 1
      max_requests: 20000
      request_timeout_seconds: 120
      idle_timeout_seconds: 300
      memory_limit_mb: 1024

# File watching settings
file_watcher:
  # Debounce delay to avoid multiple rebuilds for rapid file changes (in milliseconds)
  debounce_ms: 100 # Default: 50

# Pages directory
pages:
  # Can be relative to project root or absolute path
  directory: "pages" # Default: "pages"
